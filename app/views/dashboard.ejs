<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/style/base.css">
    <link rel="stylesheet" href="/style/dashboard.css">
    <title>Tableau de Bord - Catways</title>
</head>
<body>
    <%- include('partials/header') %>
    
    <main class="content-container">
        <% if (user) { %>
            <h1>Tableau de Bord</h1>
            <p>Bienvenue, <strong><%= user.username %></strong>. Vous êtes connecté à l'interface de gestion.</p>        
            
            <div class="dashboard-grid">
                <section class="card">
                    <h3>Gestion des Catways</h3>
                    <p>Visualisez, ajoutez ou modifiez l'état des pontons.</p>
                    <a href="/catways" class="btn btn-primary">Accéder aux Catways</a>
                </section>

                <section class="card">
                    <h3>Réservations</h3>
                    <p>Gérez les réservations de vos clients en temps réel.</p>
                    <a href="/reservations" class="btn btn-primary">Voir les Réservations</a>
                </section>

                <section class="card">
                    <h3>Administration</h3>
                    <p>Gérer les accès et les comptes agents.</p>
                    <a href="/users" class="btn btn-primary">Liste des Utilisateurs</a>
                </section>
            </div>
            <div>
                <h2>Réservations en cours</h2>
                <table class="table">
                    <thead>
                        <tr>
                            <th>Catway</th>
                            <th>Client</th>
                            <th>Bateau</th>
                            <th>Dates</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% if (typeof reservations !== 'undefined' && reservations.length > 0) { %>
                            <% reservations.forEach(resa => { %>
                                <tr>
                                    <td><strong><%= resa.catwayNumber %></strong></td>
                                    <td><%= resa.clientName %></td>
                                    <td><%= resa.boatName %></td>
                                    <td><%= new Date(resa.startDate).toLocaleDateString() %> - <%= new Date(resa.endDate).toLocaleDateString() %></td>
                                </tr>                        
                            <% }) %>
                        <% } else { %>
                            <tr><td colspan="5">Aucune réservation trouvée.</td></tr>
                        <% } %>
                    </tbody>
                    <tfoot>
                        <tr>
                            <td>
                                <a href="/reservations" class="btn btn-secondary">Voir toutes les réservations</a>
                            </td>
                        </tr>    
                    </tfoot>
                </table>
            </div>
        <% } else { %>
            <div class="alert-error">
                <h1>Accès refusé</h1>
                <p>Erreur, veuillez vérifier vos informations de connexion.</p>
                <a href="/" class="btn btn-primary">Retour à la page de connexion</a>
            </div>
        <% } %>
    </main>
    
    <%- include('partials/footer') %>
</body>
</html>